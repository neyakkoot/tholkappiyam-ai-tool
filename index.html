<script>
    // --- MAIN APPLICATION LOGIC (app.js Integrated) ---

    function analyzeWord() {
        const word = document.getElementById('wordInput').value.trim();
        const resultBox = document.getElementById('resultBox');
        const statusBadge = document.getElementById('statusBadge');
        const proofList = document.getElementById('proofList');

        if (!word) return;

        // Clear previous results
        proofList.innerHTML = '';
        resultBox.style.display = 'block';

        let isOverallValid = true;
        let proofs = [];

        // 1. மொழிமுதல் சோதனை
        let startCheck = MozhimuthalRules.check(word);
        // Fallback: title இல்லையென்றால் நாமே அமைப்பது
        if (!startCheck.title) startCheck.title = "மொழிமுதல் ஆய்வு";
        if (!startCheck.description) startCheck.description = startCheck.reason || (startCheck.isValid ? "விதிக்கு உட்பட்டது." : "விதிமீறல் கண்டறியப்பட்டது.");
        proofs.push(startCheck);
        if (!startCheck.isValid) isOverallValid = false;

        // 2. மெய்ம்மயக்கச் சோதனை
        let midCheck = MeimayakkamRules.check(word);
        if (!midCheck.title) midCheck.title = "மெய்ம்மயக்க ஆய்வு";
        if (!midCheck.description) midCheck.description = midCheck.reason || (midCheck.isValid ? "மெய்ம்மயக்கங்கள் சரியாக உள்ளன." : "விதிமீறல் கண்டறியப்பட்டது.");
        proofs.push(midCheck);
        if (!midCheck.isValid) isOverallValid = false;

        // 3. மொழியிறுதி சோதனை
        let endCheck = MozhiyiruthiRules.check(word);
        if (!endCheck.title) endCheck.title = "மொழியிறுதி ஆய்வு";
        if (!endCheck.description) endCheck.description = endCheck.reason || (endCheck.isValid ? "விதிக்கு உட்பட்டது." : "விதிமீறல் கண்டறியப்பட்டது.");
        proofs.push(endCheck);
        if (!endCheck.isValid) isOverallValid = false;

        // Update UI Badge
        if (isOverallValid) {
            statusBadge.className = 'status-badge status-valid';
            statusBadge.innerText = '✅ சரியான சொல் (Valid)';
        } else {
            statusBadge.className = 'status-badge status-invalid';
            statusBadge.innerText = '❌ பிழையான சொல் (Invalid)';
        }

        // Generate Detailed Proof List
        proofs.forEach(proof => {
            const li = document.createElement('li');
            li.className = 'proof-item';
            
            const icon = proof.isValid ? '✓' : '✖';
            const iconClass = proof.isValid ? 'icon-check' : 'icon-cross';
            
            li.innerHTML = `
                <div class="proof-icon ${iconClass}">${icon}</div>
                <div class="proof-content">
                    <h4>${proof.title}</h4>
                    <p>${proof.description}</p>
                </div>
            `;
            proofList.appendChild(li);
        });
    }
</script>
